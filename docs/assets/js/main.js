"use strict";const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const o=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(o)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result}fileField.addEventListener("change",getImage);const designTitle=document.querySelector(".js-designTitle"),designContainer=document.querySelector(".js-designContainer"),refillContainer=document.querySelector(".js-refillContainer"),shareContainer=document.querySelector(".js-shareContainer"),refillTitle=document.querySelector(".js-refillTitle"),shareTitle=document.querySelector(".js-shareTitle"),createCard=document.querySelector(".js-create-card"),twitterCard=document.querySelector(".js-twitter-card"),msgError=document.querySelector(".js-message-box"),btnTwitter=document.querySelector(".js-btn-twitter"),resetButton=document.querySelector(".js-reset-button"),previewName=document.querySelector(".js-preview-name"),previewJob=document.querySelector(".js-preview-job"),previewPhone=document.querySelector(".js-preview-phone"),previewEmail=document.querySelector(".js-preview-email"),previewLinkedin=document.querySelector(".js-preview-linkedin"),previewGitHub=document.querySelector(".js-preview-github"),cardUrl=document.querySelector(".js-cardLink"),previewPhoto=document.querySelector(".js__profile-preview"),previewMiniImage=document.querySelector(".js__profile-image"),inputName=document.querySelector(".js-input-nameCompleted"),inputJob=document.querySelector(".js-input-job"),inputEmail=document.querySelector(".js-input-email"),inputPhone=document.querySelector(".js-input-phone"),inputLinkedin=document.querySelector(".js-input-linkedin"),inputGithub=document.querySelector(".js-input-github"),inputPhoto=document.querySelector(".js__profile-upload-btn"),colorOne=document.querySelector(".js-color-1"),colorTwo=document.querySelector(".js-color-2"),colorThree=document.querySelector(".js-color-3"),borderContainer=document.querySelector(".js-container"),iconColors=document.querySelector(".js-icons"),iconColorsOne=document.querySelector(".js-icons-1"),iconColorsTwo=document.querySelector(".js-icons-2"),iconColorsThree=document.querySelector(".js-icons-3"),form=document.querySelector(".js-form");let data={palette:1,name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:""};const twitterLink=document.querySelector(".js-twitter-link"),infoData=JSON.parse(localStorage.getItem("dataForm"));function showDesign(){designContainer.classList.remove("collapsed")}function collapRefill(){refillContainer.classList.add("collapsed")}function collapShare(){shareContainer.classList.add("collapsed")}function showRefill(){refillContainer.classList.remove("collapsed")}function collapDesign(){designContainer.classList.add("collapsed")}function showShare(){shareContainer.classList.remove("collapsed")}function showCreateCard(e){twitterCard.classList.remove("hidden"),createCard.classList.add("pulsed-grey"),cardUrl.innerHTML=e.cardURL,cardUrl.href=e.cardURL,btnTwitter.classList.remove("hidden"),twitterLink.href="https://twitter.com/intent/tweet?text=Mira%20mi%20nueva%20tarjeta%20de%20perfil&url="+e.cardURL}function sectionShareReset(){twitterCard.classList.add("hidden"),createCard.classList.remove("pulsed-grey"),cardUrl.innerHTML="",cardUrl.href="",twitterLink.href="",btnTwitter.classList.add("hidden"),msgError.classList.add("hidden")}function handleClickDesingTitle(){showDesign(),collapRefill(),collapShare()}function handleClickRefillTitle(){showRefill(),collapDesign(),collapShare()}function handleClickShareTitle(){showShare(),collapDesign(),collapRefill()}function handleClickCreateCard(e){e.preventDefault(),fetch("https://dev.adalab.es/api/card/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{if(!1===e.success){if(msgError.classList.remove("hidden"),msgError.innerHTML='Uy! No se pudo crear la tarjeta, revisa los campos <i class="fa-regular fa-face-sad-cry"></i>',"Database error: ER_DATA_TOO_LONG"===e.error)return void alert("Imagen demasiado grande, prueba con una de menos de 40kb")}else{if(!inputEmail.value.includes("@")||inputPhone.value.length<9||!/^\d+$/.test(inputPhone.value)||!inputLinkedin.value.includes("linkedin.com")||!inputGithub.value.includes("@"))return void alert("Por favor, revisa si email, teléfono, linkedin y Github son válidos");showCreateCard(e),msgError.classList.add("hidden"),cardUrl.href=e.cardURL,cardUrl.innerHTML=e.cardURL,localStorage.setItem("dataForm",JSON.stringify(data))}})}function handleResetInput(e){e.preventDefault(e),inputName.value="",inputJob.value="",inputEmail.value="",previewEmail.href="#",inputPhone.value="",previewPhone.href="#",inputLinkedin.value="",previewLinkedin.href="#",inputGithub.value="",previewGitHub.href="#",previewName.innerHTML="Nombre Apellido",previewJob.innerHTML="Front-end developer",colorOne.checked=!0,previewPhoto.style.backgroundImage="url('./assets/images/profileUser2.jpg')",previewMiniImage.style.backgroundImage="url('./assets/images/profileUser2.jpg')",sectionShareReset(),handleClickColorOne(),localStorage.removeItem("dataForm",JSON.stringify(data))}function updatePreview(){previewName.innerHTML=data.name.replace("<",""),previewJob.innerHTML=data.job.replace("<",""),previewPhone.href="tel:"+data.phone,previewEmail.href="mailto:"+data.email,previewLinkedin.href="https://"+data.linkedin,previewGitHub.href="https://github.com/"+data.github.slice(1),previewPhoto.src=data.photo,""===data.name?previewName.innerHTML="Nombre Apellido":previewName.innerHTML=inputName.value,""===data.job?previewJob.innerHTML="Front-end developer":previewJob.innerHTML=inputJob.value}function handleInputForm(e){"photo"!==e.target.name?(data[e.target.name]=e.target.value,updatePreview()):data[e.target.name]=e.target.files[0]}function handleClickColorOne(){colorOne.getAttribute("checked"),previewName.classList.remove("nameRed"),previewName.classList.remove("nameBlue"),borderContainer.classList.remove("containerRed"),borderContainer.classList.remove("containerYellow"),borderContainer.classList.add("containerBlue"),iconColors.classList.remove("liRed"),iconColorsOne.classList.remove("liRed"),iconColorsTwo.classList.remove("liRed"),iconColorsThree.classList.remove("liRed"),iconColors.classList.remove("liGrey"),iconColorsOne.classList.remove("liGrey"),iconColorsTwo.classList.remove("liGrey"),iconColorsThree.classList.remove("liGrey"),iconColors.classList.add("liBlue"),iconColorsOne.classList.add("liBlue"),iconColorsTwo.classList.add("liBlue"),iconColorsThree.classList.add("liBlue")}function handleClickColorTwo(){previewName.classList.add("nameRed"),previewName.classList.remove("nameBlue"),borderContainer.classList.add("containerRed"),borderContainer.classList.remove("containerBlue"),borderContainer.classList.remove("containerYellow"),iconColors.classList.add("liRed"),iconColorsOne.classList.add("liRed"),iconColorsTwo.classList.add("liRed"),iconColorsThree.classList.add("liRed"),iconColors.classList.remove("liBlue"),iconColorsOne.classList.remove("liBlue"),iconColorsTwo.classList.remove("liBlue"),iconColorsThree.classList.remove("liBlue"),iconColors.classList.remove("liGrey"),iconColorsOne.classList.remove("liGrey"),iconColorsTwo.classList.remove("liGrey"),iconColorsThree.classList.remove("liGrey")}function handleClickColorThree(){previewName.classList.add("nameBlue"),borderContainer.classList.remove("containerRed"),borderContainer.classList.remove("containerBlue"),borderContainer.classList.add("containerYellow"),iconColors.classList.add("liGrey"),iconColorsOne.classList.add("liGrey"),iconColorsTwo.classList.add("liGrey"),iconColorsThree.classList.add("liGrey"),iconColors.classList.remove("liBlue"),iconColorsOne.classList.remove("liBlue"),iconColorsTwo.classList.remove("liBlue"),iconColorsThree.classList.remove("liBlue"),iconColors.classList.remove("liRed"),iconColorsOne.classList.remove("liRed"),iconColorsTwo.classList.remove("liRed"),iconColorsThree.classList.remove("liRed")}function getDataLs(){null!==infoData&&(data.palette=infoData.palette,1==infoData.palette?(handleClickColorOne(),colorOne.checked=!0):2==infoData.palette?(handleClickColorTwo(),colorTwo.checked=!0):(handleClickColorThree(),colorThree.checked=!0),data.name=infoData.name,data.job=infoData.job,data.phone=infoData.phone,data.email=infoData.email,data.linkedin=infoData.linkedin,data.github=infoData.github,data.photo=infoData.photo,inputName.value=data.name,inputJob.value=data.job,inputPhone.value=data.phone,inputEmail.value=data.email,inputLinkedin.value=data.linkedin,inputGithub.value=data.github,previewName.innerHTML=infoData.name,previewJob.innerHTML=infoData.job,profileImage.style.backgroundImage=`url(${infoData.photo})`,profilePreview.style.backgroundImage=`url(${infoData.photo})`,updatePreview())}getDataLs(),designTitle.addEventListener("click",handleClickDesingTitle),refillTitle.addEventListener("click",handleClickRefillTitle),shareTitle.addEventListener("click",handleClickShareTitle),createCard.addEventListener("click",handleClickCreateCard),resetButton.addEventListener("click",handleResetInput),colorOne.addEventListener("click",handleClickColorOne),colorTwo.addEventListener("click",handleClickColorTwo),colorThree.addEventListener("click",handleClickColorThree),form.addEventListener("input",handleInputForm);